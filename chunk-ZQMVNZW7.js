import{Aa as H,B as S,C,D as O,Ea as W,Fa as z,H as b,I as F,Ia as k,Ja as q,K as T,La as J,N as P,Na as K,O as y,Ra as Q,Va as V,Ya as X,Z as M,Za as Y,aa as A,e as I,ea as R,f as x,ha as D,k as l,l as v,m as L,ma as U,n as u,o as m,oa as G,p as t,pa as N,q as i,r as d,rb as Z,t as _,u as g,ua as w,w as r,x as h,xa as j,y as f,ya as B,za as $}from"./chunk-B4HSYOOP.js";import"./chunk-MWWENCHY.js";import"./chunk-7KGURMOZ.js";import"./chunk-JV5DO3IJ.js";import"./chunk-L3SNWROS.js";import"./chunk-EYYNAE2V.js";import"./chunk-JVTPOORY.js";import"./chunk-CLDSZD2A.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-G7SWQJ6W.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import"./chunk-JHI3MBHO.js";var ee=(()=>{let o=class o{constructor(e){this.http=e,this.apiUrl=`${X.apiUrl}/logs`}obtenerLogs(e){let a=new P;return e&&Object.keys(e).forEach(s=>{e[s]!==null&&e[s]!==void 0&&e[s]!==""&&(a=a.set(s,e[s]))}),this.http.get(this.apiUrl,{params:a})}obtenerEstadisticasLogs(){return this.http.get(`${this.apiUrl}/estadisticas`)}obtenerLog(e){return this.http.get(`${this.apiUrl}/${e}`)}};o.\u0275fac=function(a){return new(a||o)(x(y))},o.\u0275prov=I({token:o,factory:o.\u0275fac,providedIn:"root"});let n=o;return n})();function ne(n,o){n&1&&(t(0,"div",15),d(1,"ion-spinner"),i())}function oe(n,o){if(n&1&&(t(0,"p"),r(1),i()),n&2){let c=g().$implicit;l(),f("IP: ",c.ip)}}function re(n,o){if(n&1&&(t(0,"p"),r(1),i()),n&2){let c=g().$implicit;l(),h(c.descripcion)}}function ae(n,o){if(n&1&&(t(0,"ion-card")(1,"ion-item"),d(2,"ion-icon",17),t(3,"ion-label")(4,"h2")(5,"ion-badge",18),r(6),i(),r(7),i(),t(8,"p"),r(9),i(),u(10,oe,2,1,"p",14)(11,re,2,1,"p",14),t(12,"p",19),r(13),i()(),t(14,"ion-badge",20),r(15),i()()()),n&2){let c=o.$implicit,e=g(2);l(2),m("color",e.obtenerColorAccion(c.accion)),l(3),m("color",e.obtenerColorAccion(c.accion)),l(),h(c.accion),l(),f(" ",c.entidad," "),l(2),f("Usuario: ",e.getUsuarioNombre(c)),l(),m("ngIf",c.ip),l(),m("ngIf",c.descripcion),l(2),h(e.formatearFecha(c.createdAt)),l(),m("color",c.exitoso?"success":"danger"),l(),f(" ",c.exitoso?"\u2713":"\u2717"," ")}}function le(n,o){if(n&1&&(t(0,"ion-list"),u(1,ae,16,10,"ion-card",16),i()),n&2){let c=g();l(),m("ngForOf",c.logsFiltrados)}}var Ee=(()=>{let o=class o{constructor(e){this.logService=e,this.logs=[],this.logsFiltrados=[],this.cargando=!1,this.accionFiltro="",Y({fingerPrintOutline:Z})}ngOnInit(){this.cargarLogs()}cargarLogs(e){this.cargando=!0,this.logService.obtenerLogs().subscribe({next:a=>{a.success&&a.data&&(this.logs=a.data,this.aplicarFiltros()),this.cargando=!1,e&&e.target.complete()},error:a=>{console.error("Error:",a),this.cargando=!1,e&&e.target.complete()}})}filtrarPorAccion(e){this.accionFiltro=e.target.value,this.aplicarFiltros()}aplicarFiltros(){this.logsFiltrados=this.logs.filter(e=>!this.accionFiltro||e.accion===this.accionFiltro)}obtenerColorAccion(e){return{CREATE:"success",READ:"primary",UPDATE:"warning",DELETE:"danger",LOGIN:"tertiary",LOGOUT:"medium",LOGIN_FAILED:"danger",REGISTER:"success"}[e]||"medium"}formatearFecha(e){return new Date(e).toLocaleString("es-EC")}getUsuarioNombre(e){return typeof e.usuario=="object"&&e.usuario?e.usuario.nombreUsuario:"Sistema"}};o.\u0275fac=function(a){return new(a||o)(v(ee))},o.\u0275cmp=L({type:o,selectors:[["app-logs"]],decls:31,vars:3,consts:[["slot","start"],["defaultHref","/dashboard"],["placeholder","Filtrar por acci\xF3n","interface","popover",3,"ionChange","ngModelChange","ngModel"],["value",""],["value","CREATE"],["value","READ"],["value","UPDATE"],["value","DELETE"],["value","LOGIN"],["value","LOGOUT"],["value","LOGIN_FAILED"],["value","REGISTER"],["slot","fixed",3,"ionRefresh"],["class","loading-container",4,"ngIf"],[4,"ngIf"],[1,"loading-container"],[4,"ngFor","ngForOf"],["name","finger-print-outline","slot","start",3,"color"],[3,"color"],[1,"fecha"],["slot","end",3,"color"]],template:function(a,s){a&1&&(t(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),d(3,"ion-back-button",1),i(),t(4,"ion-title"),r(5,"Logs del Sistema"),i()(),t(6,"ion-toolbar")(7,"ion-select",2),_("ionChange",function(p){return s.filtrarPorAccion(p)}),O("ngModelChange",function(p){return C(s.accionFiltro,p)||(s.accionFiltro=p),p}),t(8,"ion-select-option",3),r(9,"Todas"),i(),t(10,"ion-select-option",4),r(11,"CREATE"),i(),t(12,"ion-select-option",5),r(13,"READ"),i(),t(14,"ion-select-option",6),r(15,"UPDATE"),i(),t(16,"ion-select-option",7),r(17,"DELETE"),i(),t(18,"ion-select-option",8),r(19,"LOGIN"),i(),t(20,"ion-select-option",9),r(21,"LOGOUT"),i(),t(22,"ion-select-option",10),r(23,"LOGIN_FAILED"),i(),t(24,"ion-select-option",11),r(25,"REGISTER"),i()()()(),t(26,"ion-content")(27,"ion-refresher",12),_("ionRefresh",function(p){return s.cargarLogs(p)}),d(28,"ion-refresher-content"),i(),u(29,ne,2,0,"div",13)(30,le,2,1,"ion-list",14),i()),a&2&&(l(7),S("ngModel",s.accionFiltro),l(22),m("ngIf",s.cargando),l(),m("ngIf",!s.cargando))},dependencies:[T,b,F,R,M,A,j,K,J,w,G,D,H,N,B,$,U,Q,W,z,q,V,k],styles:[".loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:200px}ion-card[_ngcontent-%COMP%]{margin:12px}ion-item[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-weight:600}ion-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.85rem;color:var(--ion-color-medium);margin:4px 0}ion-item[_ngcontent-%COMP%]   p.fecha[_ngcontent-%COMP%]{font-size:.8rem;margin-top:8px}ion-select[_ngcontent-%COMP%]{width:100%;max-width:300px;padding:0 16px}"]});let n=o;return n})();export{Ee as LogsPage};
