import{a as ee}from"./chunk-32Z5TGRM.js";import{Aa as B,I as b,Ja as H,K as O,La as L,Ma as $,Na as U,R as E,Ra as q,T as S,Za as G,db as J,eb as K,h as f,ha as P,hb as Q,i as g,ib as W,ja as y,k as i,kb as X,l as C,m as I,ma as T,mb as Y,n as v,na as M,o as c,oa as R,p as t,pa as D,q as n,qa as z,r as p,ra as A,s as x,sa as F,t as _,u as m,ua as w,w as a,x as h,xa as j,y as u,ya as V,z as k,za as N,zb as Z}from"./chunk-B4HSYOOP.js";import"./chunk-MWWENCHY.js";import"./chunk-7KGURMOZ.js";import"./chunk-JV5DO3IJ.js";import"./chunk-L3SNWROS.js";import"./chunk-EYYNAE2V.js";import"./chunk-JVTPOORY.js";import"./chunk-CLDSZD2A.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-G7SWQJ6W.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import"./chunk-JHI3MBHO.js";function te(r,s){r&1&&(t(0,"div",8),p(1,"ion-spinner"),n())}function ne(r,s){if(r&1&&(t(0,"div",29)(1,"span"),a(2,"Descuento cliente frecuente:"),n(),t(3,"span"),a(4),n()()),r&2){let e=m(2);i(4),u("-",e.formatearMoneda(e.reserva.descuentoClienteFrecuente))}}function re(r,s){if(r&1&&(t(0,"div",15)(1,"span"),a(2,"IVA (15%):"),n(),t(3,"span"),a(4),n()()),r&2){let e=m(2);i(4),h(e.formatearMoneda(e.reserva.iva))}}function ie(r,s){if(r&1&&(t(0,"div",30)(1,"span"),a(2),n(),t(3,"span"),a(4),n()()),r&2){let e=m(2);i(2),u("Recargo feriado (",e.reserva.recargoPorcentaje,"%):"),i(2),u("+",e.formatearMoneda(e.reserva.recargoFeriado))}}function ae(r,s){if(r&1&&(t(0,"p"),a(1),n()),r&2){let e=m(2);i(),u(" ",e.formatearFecha(e.reserva.checkIn.fecha)," ")}}function oe(r,s){r&1&&(t(0,"p",31),a(1," Pendiente "),n())}function ce(r,s){if(r&1&&(t(0,"p"),a(1),n()),r&2){let e=m(2);i(),u(" ",e.formatearFecha(e.reserva.checkOut.fecha)," ")}}function se(r,s){r&1&&(t(0,"p",31),a(1," Pendiente "),n())}function le(r,s){if(r&1&&(t(0,"p"),a(1),n()),r&2){let e=m(3);i(),h(e.reserva.observaciones)}}function de(r,s){if(r&1&&(t(0,"p")(1,"strong"),a(2,"Solicitudes:"),n(),a(3),n()),r&2){let e=m(3);i(3),u(" ",e.reserva.solicitudesEspeciales)}}function me(r,s){if(r&1&&(t(0,"ion-card")(1,"ion-card-header")(2,"ion-card-title"),a(3,"Observaciones"),n()(),t(4,"ion-card-content"),v(5,le,2,1,"p",3)(6,de,4,1,"p",3),n()()),r&2){let e=m(2);i(5),c("ngIf",e.reserva.observaciones),i(),c("ngIf",e.reserva.solicitudesEspeciales)}}function pe(r,s){if(r&1){let e=x();t(0,"ion-button",32),_("click",function(){f(e);let l=m(2);return g(l.mostrarAlertCheckIn=!0)}),p(1,"ion-icon",33),a(2," Realizar Check-in "),n()}}function ue(r,s){if(r&1){let e=x();t(0,"ion-button",34),_("click",function(){f(e);let l=m(2);return g(l.mostrarAlertCheckOut=!0)}),p(1,"ion-icon",33),a(2," Realizar Check-out "),n()}}function ve(r,s){if(r&1){let e=x();t(0,"ion-button",35),_("click",function(){f(e);let l=m(2);return g(l.mostrarAlertCancelar=!0)}),p(1,"ion-icon",36),a(2," Cancelar Reserva "),n()}}function he(r,s){if(r&1){let e=x();t(0,"div")(1,"ion-card")(2,"ion-card-header")(3,"div",9)(4,"ion-card-title"),a(5),n(),t(6,"ion-badge",10),a(7),n()()(),t(8,"ion-card-content")(9,"ion-list")(10,"ion-item"),p(11,"ion-icon",11),t(12,"ion-label")(13,"h3"),a(14,"Cliente"),n(),t(15,"p"),a(16),n()()(),t(17,"ion-item"),p(18,"ion-icon",12),t(19,"ion-label")(20,"h3"),a(21,"Departamento"),n(),t(22,"p"),a(23),n()()(),t(24,"ion-item"),p(25,"ion-icon",13),t(26,"ion-label")(27,"h3"),a(28,"Fechas"),n(),t(29,"p"),a(30),n(),t(31,"p"),a(32),n()()()()()(),t(33,"ion-card")(34,"ion-card-header")(35,"ion-card-title"),a(36,"Detalles Financieros"),n()(),t(37,"ion-card-content")(38,"div",14)(39,"div",15)(40,"span"),a(41,"Precio por noche:"),n(),t(42,"span"),a(43),n()(),t(44,"div",15)(45,"span"),a(46),n(),t(47,"span"),a(48),n()(),v(49,ne,5,1,"div",16)(50,re,5,1,"div",17)(51,ie,5,2,"div",18),t(52,"div",19)(53,"strong"),a(54,"TOTAL:"),n(),t(55,"strong",20),a(56),n()()()()(),t(57,"ion-card")(58,"ion-card-header")(59,"ion-card-title"),a(60,"Check-in / Check-out"),n()(),t(61,"ion-card-content")(62,"ion-list")(63,"ion-item"),p(64,"ion-icon",21),t(65,"ion-label")(66,"h3"),a(67,"Check-in"),n(),v(68,ae,2,1,"p",3)(69,oe,2,0,"p",22),n()(),t(70,"ion-item"),p(71,"ion-icon",21),t(72,"ion-label")(73,"h3"),a(74,"Check-out"),n(),v(75,ce,2,1,"p",3)(76,se,2,0,"p",22),n()()()()(),v(77,me,7,2,"ion-card",3),t(78,"div",23),v(79,pe,3,0,"ion-button",24)(80,ue,3,0,"ion-button",25),t(81,"ion-button",26),_("click",function(){f(e);let l=m();return g(l.verFactura())}),p(82,"ion-icon",27),a(83," Ver Factura "),n(),v(84,ve,3,0,"ion-button",28),n()()}if(r&2){let e=m();i(5),h(e.reserva.codigoReserva),i(),c("color",e.obtenerColorEstado(e.reserva.estado)),i(),u(" ",e.reserva.estado," "),i(9),h(e.getNombreCliente()),i(7),h(e.getInfoDepartamento()),i(7),k("",e.formatearFecha(e.reserva.fechaInicio)," - ",e.formatearFecha(e.reserva.fechaFin)),i(2),u("",e.reserva.numeroNoches," noche(s)"),i(11),h(e.formatearMoneda(e.reserva.precioNoche)),i(3),u("Subtotal (",e.reserva.numeroNoches," noches):"),i(2),h(e.formatearMoneda(e.reserva.subtotal)),i(),c("ngIf",e.reserva.descuentoClienteFrecuente>0),i(),c("ngIf",e.reserva.aplicaIVA),i(),c("ngIf",e.reserva.esFeriado&&e.reserva.recargoFeriado>0),i(5),h(e.formatearMoneda(e.reserva.total)),i(8),c("name",e.reserva.checkIn.realizado?"checkmark-circle-outline":"close-circle-outline")("color",e.reserva.checkIn.realizado?"success":"medium"),i(4),c("ngIf",e.reserva.checkIn.realizado),i(),c("ngIf",!e.reserva.checkIn.realizado),i(2),c("name",e.reserva.checkOut.realizado?"checkmark-circle-outline":"close-circle-outline")("color",e.reserva.checkOut.realizado?"success":"medium"),i(4),c("ngIf",e.reserva.checkOut.realizado),i(),c("ngIf",!e.reserva.checkOut.realizado),i(),c("ngIf",e.reserva.observaciones||e.reserva.solicitudesEspeciales),i(2),c("ngIf",e.puedeHacerCheckIn()),i(),c("ngIf",e.puedeHacerCheckOut()),i(4),c("ngIf",e.puedeCancelar())}}var Ee=(()=>{let s=class s{constructor(o,l,d){this.route=o,this.router=l,this.reservaService=d,this.reserva=null,this.cargando=!0,this.mostrarAlertCancelar=!1,this.mostrarAlertCheckIn=!1,this.mostrarAlertCheckOut=!1,this.mostrarToast=!1,this.mensajeToast="",this.botonesCheckIn=[{text:"Cancelar",role:"cancel",handler:()=>{this.mostrarAlertCheckIn=!1}},{text:"Confirmar",handler:()=>{this.realizarCheckIn(),this.mostrarAlertCheckIn=!1}}],this.botonesCheckOut=[{text:"Cancelar",role:"cancel",handler:()=>{this.mostrarAlertCheckOut=!1}},{text:"Confirmar",handler:()=>{this.realizarCheckOut(),this.mostrarAlertCheckOut=!1}}],this.botonesCancelar=[{text:"No",role:"cancel",handler:()=>{this.mostrarAlertCancelar=!1}},{text:"S\xED, cancelar",role:"destructive",handler:()=>{this.cancelarReserva()}}],G({calendarOutline:K,personOutline:Z,bedOutline:J,cashOutline:Q,checkmarkCircleOutline:W,closeCircleOutline:X,documentsOutline:Y})}ngOnInit(){let o=this.route.snapshot.paramMap.get("id");o&&this.cargarReserva(o)}cargarReserva(o){this.cargando=!0,this.reservaService.obtenerReserva(o).subscribe({next:l=>{l.success&&l.data&&(this.reserva=l.data),this.cargando=!1},error:l=>{console.error("Error al cargar reserva:",l),this.cargando=!1}})}realizarCheckIn(){this.reserva&&this.reservaService.checkIn(this.reserva.id).subscribe({next:o=>{o.success&&(this.mensajeToast="Check-in realizado exitosamente",this.mostrarToast=!0,this.cargarReserva(this.reserva.id))},error:o=>{this.mensajeToast="Error al realizar check-in",this.mostrarToast=!0}})}realizarCheckOut(){this.reserva&&this.reservaService.checkOut(this.reserva.id).subscribe({next:o=>{o.success&&(this.mensajeToast="Check-out realizado exitosamente",this.mostrarToast=!0,this.cargarReserva(this.reserva.id))},error:o=>{this.mensajeToast="Error al realizar check-out",this.mostrarToast=!0}})}cancelarReserva(){this.reserva&&this.reservaService.cancelarReserva(this.reserva.id).subscribe({next:o=>{o.success&&(this.mensajeToast="Reserva cancelada exitosamente",this.mostrarToast=!0,this.mostrarAlertCancelar=!1,this.cargarReserva(this.reserva.id))},error:o=>{this.mensajeToast="Error al cancelar reserva",this.mostrarToast=!0}})}verFactura(){this.router.navigate(["/facturas"])}obtenerColorEstado(o){return{pendiente:"warning",confirmada:"primary","en-curso":"success",completada:"medium",cancelada:"danger"}[o]||"medium"}formatearFecha(o){return new Date(o).toLocaleDateString("es-EC",{day:"2-digit",month:"long",year:"numeric"})}formatearMoneda(o){return new Intl.NumberFormat("es-EC",{style:"currency",currency:"USD"}).format(o)}getNombreCliente(){return this.reserva&&typeof this.reserva.cliente=="object"?`${this.reserva.cliente.nombres} ${this.reserva.cliente.apellidos}`:"N/A"}getInfoDepartamento(){return this.reserva&&typeof this.reserva.departamento=="object"?`${this.reserva.departamento.numero} - ${this.reserva.departamento.tipo}`:"N/A"}puedeHacerCheckIn(){return this.reserva?.estado==="confirmada"&&!this.reserva?.checkIn.realizado}puedeHacerCheckOut(){return this.reserva?.estado==="en-curso"&&this.reserva?.checkIn.realizado&&!this.reserva?.checkOut.realizado}puedeCancelar(){return this.reserva?.estado==="pendiente"||this.reserva?.estado==="confirmada"}};s.\u0275fac=function(l){return new(l||s)(C(E),C(S),C(ee))},s.\u0275cmp=I({type:s,selectors:[["app-detalle-reserva"]],decls:13,vars:11,consts:[["slot","start"],["defaultHref","/reservas"],["class","loading-container",4,"ngIf"],[4,"ngIf"],["header","Confirmar Check-in","message","\xBFEst\xE1 seguro de realizar el check-in para esta reserva?",3,"isOpen","buttons"],["header","Confirmar Check-out","message","\xBFEst\xE1 seguro de realizar el check-out para esta reserva?",3,"isOpen","buttons"],["header","Cancelar Reserva","message","\xBFEst\xE1 seguro de cancelar esta reserva? Esta acci\xF3n no se puede deshacer.",3,"isOpen","buttons"],[3,"didDismiss","isOpen","message","duration"],[1,"loading-container"],[1,"header-content"],[3,"color"],["name","person-outline","slot","start"],["name","bed-outline","slot","start"],["name","calendar-outline","slot","start"],[1,"precio-detalle"],[1,"precio-item"],["class","precio-item descuento",4,"ngIf"],["class","precio-item",4,"ngIf"],["class","precio-item recargo",4,"ngIf"],[1,"precio-item","total"],[1,"precio-total"],["slot","start",3,"name","color"],["class","pendiente",4,"ngIf"],[1,"acciones-container"],["expand","block","color","success",3,"click",4,"ngIf"],["expand","block","color","primary",3,"click",4,"ngIf"],["expand","block","color","tertiary",3,"click"],["name","documents-outline","slot","start"],["expand","block","color","danger","fill","outline",3,"click",4,"ngIf"],[1,"precio-item","descuento"],[1,"precio-item","recargo"],[1,"pendiente"],["expand","block","color","success",3,"click"],["name","checkmark-circle-outline","slot","start"],["expand","block","color","primary",3,"click"],["expand","block","color","danger","fill","outline",3,"click"],["name","close-circle-outline","slot","start"]],template:function(l,d){l&1&&(t(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),p(3,"ion-back-button",1),n(),t(4,"ion-title"),a(5,"Detalle de Reserva"),n()()(),t(6,"ion-content"),v(7,te,2,0,"div",2)(8,he,85,27,"div",3),p(9,"ion-alert",4)(10,"ion-alert",5)(11,"ion-alert",6),t(12,"ion-toast",7),_("didDismiss",function(){return d.mostrarToast=!1}),n()()),l&2&&(i(7),c("ngIf",d.cargando),i(),c("ngIf",!d.cargando&&d.reserva),i(),c("isOpen",d.mostrarAlertCheckIn)("buttons",d.botonesCheckIn),i(),c("isOpen",d.mostrarAlertCheckOut)("buttons",d.botonesCheckOut),i(),c("isOpen",d.mostrarAlertCancelar)("buttons",d.botonesCancelar),i(),c("isOpen",d.mostrarToast)("message",d.mensajeToast)("duration",3e3))},dependencies:[O,b,j,U,L,w,R,P,D,A,F,z,B,V,N,T,M,q,H,y,$],styles:[".loading-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:200px}ion-card[_ngcontent-%COMP%]{margin:12px}.header-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.header-content[_ngcontent-%COMP%]   ion-card-title[_ngcontent-%COMP%]{font-size:1.2rem;font-weight:600}.precio-detalle[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.precio-detalle[_ngcontent-%COMP%]   .precio-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:8px 0}.precio-detalle[_ngcontent-%COMP%]   .precio-item.descuento[_ngcontent-%COMP%]{color:var(--ion-color-success)}.precio-detalle[_ngcontent-%COMP%]   .precio-item.recargo[_ngcontent-%COMP%]{color:var(--ion-color-warning)}.precio-detalle[_ngcontent-%COMP%]   .precio-item.total[_ngcontent-%COMP%]{margin-top:12px;padding-top:12px;border-top:2px solid var(--ion-color-primary);font-size:1.1rem}.precio-detalle[_ngcontent-%COMP%]   .precio-item.total[_ngcontent-%COMP%]   .precio-total[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-size:1.3rem}.pendiente[_ngcontent-%COMP%]{color:var(--ion-color-medium);font-style:italic}.acciones-container[_ngcontent-%COMP%]{padding:16px;display:flex;flex-direction:column;gap:12px}.acciones-container[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{--border-radius: 12px}ion-list[_ngcontent-%COMP%]{background:transparent}ion-item[_ngcontent-%COMP%]{--background: transparent}ion-item[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:1.5rem}ion-item[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-weight:600;margin-bottom:4px}ion-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.9rem;color:var(--ion-color-medium)}"]});let r=s;return r})();export{Ee as DetalleReservaPage};
