import{a as te}from"./chunk-5UTYIGBG.js";import{a as ee}from"./chunk-LHZOH3EE.js";import{a as $}from"./chunk-32Z5TGRM.js";import{A as y,Aa as G,B as g,C as h,Cb as Z,D as x,H as M,I as w,Ia as H,Ja as A,K as P,La as q,Na as z,Qa as J,Ra as K,T,Va as Q,Wa as U,Z as E,Za as X,aa as R,ea as F,h as p,ha as V,i as _,ia as O,k as l,l as v,lb as Y,m as b,n as u,na as D,o as s,oa as W,p as o,q as r,r as f,s as C,t as S,u as d,ua as k,va as N,w as m,xa as B,y as I,ya as L,za as j}from"./chunk-B4HSYOOP.js";import"./chunk-MWWENCHY.js";import"./chunk-7KGURMOZ.js";import"./chunk-JV5DO3IJ.js";import"./chunk-L3SNWROS.js";import"./chunk-EYYNAE2V.js";import"./chunk-JVTPOORY.js";import"./chunk-CLDSZD2A.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-G7SWQJ6W.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import"./chunk-JHI3MBHO.js";function ne(i,c){if(i&1&&(o(0,"ion-select-option",13),m(1),r()),i&2){let e=c.$implicit;s("value",e.id),l(),y(" ",e.nombres," ",e.apellidos," - ",e.cedula," ")}}function oe(i,c){if(i&1&&(o(0,"ion-select-option",13),m(1),r()),i&2){let e=c.$implicit;s("value",e.id),l(),y(" ",e.numero," - ",e.tipo," ($",e.precioNoche,"/noche) ")}}function ae(i,c){if(i&1){let e=C();o(0,"ion-datetime",14),x("ngModelChange",function(t){p(e);let a=d(2);return h(a.formulario.fechaInicio,t)||(a.formulario.fechaInicio=t),_(t)}),r()}if(i&2){let e=d(2);g("ngModel",e.formulario.fechaInicio),s("min",e.minDate)}}function re(i,c){if(i&1){let e=C();o(0,"ion-datetime",15),x("ngModelChange",function(t){p(e);let a=d(2);return h(a.formulario.fechaFin,t)||(a.formulario.fechaFin=t),_(t)}),r()}if(i&2){let e=d(2);g("ngModel",e.formulario.fechaFin),s("min",e.formulario.fechaInicio||e.minDate)}}function le(i,c){if(i&1&&(o(0,"ion-item")(1,"ion-label")(2,"h3"),m(3,"N\xFAmero de noches"),r(),o(4,"p"),m(5),r()()()),i&2){let e=d(2);l(5),I("",e.calcularNoches()," noche(s)")}}function ce(i,c){if(i&1&&(o(0,"ion-item")(1,"ion-label")(2,"h3"),m(3,"Costo Total"),r(),o(4,"p"),m(5),r()()()),i&2){let e=d(2);l(5),I("$",e.calcularTotal().toFixed(2))}}function se(i,c){if(i&1){let e=C();o(0,"ion-list")(1,"ion-item")(2,"ion-select",6),x("ngModelChange",function(t){p(e);let a=d();return h(a.formulario.clienteId,t)||(a.formulario.clienteId=t),_(t)}),u(3,ne,2,4,"ion-select-option",7),r()(),o(4,"ion-item")(5,"ion-select",8),x("ngModelChange",function(t){p(e);let a=d();return h(a.formulario.departamentoId,t)||(a.formulario.departamentoId=t),_(t)}),u(6,oe,2,4,"ion-select-option",7),r()(),o(7,"ion-item")(8,"ion-label"),m(9,"Fecha Inicio"),r(),f(10,"ion-datetime-button",9),o(11,"ion-modal",10),u(12,ae,1,2,"ng-template"),r()(),o(13,"ion-item")(14,"ion-label"),m(15,"Fecha Fin"),r(),f(16,"ion-datetime-button",11),o(17,"ion-modal",10),u(18,re,1,2,"ng-template"),r()(),u(19,le,6,1,"ion-item",3)(20,ce,6,1,"ion-item",3),o(21,"ion-item")(22,"ion-textarea",12),x("ngModelChange",function(t){p(e);let a=d();return h(a.formulario.observaciones,t)||(a.formulario.observaciones=t),_(t)}),r()()()}if(i&2){let e=d();l(2),g("ngModel",e.formulario.clienteId),l(),s("ngForOf",e.clientes),l(2),g("ngModel",e.formulario.departamentoId),l(),s("ngForOf",e.departamentos),l(5),s("keepContentsMounted",!0),l(6),s("keepContentsMounted",!0),l(2),s("ngIf",e.calcularNoches()>0),l(),s("ngIf",e.calcularTotal()>0),l(2),g("ngModel",e.formulario.observaciones)}}function de(i,c){i&1&&(o(0,"div",16),f(1,"ion-spinner"),o(2,"p"),m(3,"Cargando datos..."),r()())}function me(i,c){if(i&1){let e=C();o(0,"div",17)(1,"ion-button",18),S("click",function(){p(e);let t=d();return _(t.cancelar())}),f(2,"ion-icon",19),m(3," Cancelar "),r(),o(4,"ion-button",20),S("click",function(){p(e);let t=d();return _(t.guardarReserva())}),f(5,"ion-icon",21),m(6),r()()}if(i&2){let e=d();l(4),s("disabled",!e.validarFormulario()||e.guardando),l(2),I(" ",e.guardando?"Guardando...":"Guardar Reserva"," ")}}var be=(()=>{let c=class c{constructor(n,t,a,ie){this.router=n,this.reservaService=t,this.clienteService=a,this.departamentoService=ie,this.clientes=[],this.departamentos=[],this.cargando=!1,this.guardando=!1,this.minDate=new Date().toISOString(),this.formulario={clienteId:"",departamentoId:"",fechaInicio:"",fechaFin:"",observaciones:""},X({saveOutline:Z,closeOutline:Y})}ngOnInit(){this.cargarDatos()}cargarDatos(){this.cargando=!0,this.clienteService.obtenerClientes().subscribe({next:n=>{n.success&&(this.clientes=n.data)},error:n=>console.error("Error al cargar clientes:",n)}),this.departamentoService.obtenerDepartamentos("disponible").subscribe({next:n=>{n.success&&(this.departamentos=n.data),this.cargando=!1},error:n=>{console.error("Error al cargar departamentos:",n),this.cargando=!1}})}calcularNoches(){if(this.formulario.fechaInicio&&this.formulario.fechaFin){let n=new Date(this.formulario.fechaInicio),a=new Date(this.formulario.fechaFin).getTime()-n.getTime();return Math.ceil(a/(1e3*60*60*24))}return 0}calcularTotal(){let n=this.departamentos.find(t=>t.id===this.formulario.departamentoId);return n?this.calcularNoches()*n.precioNoche:0}validarFormulario(){return!!(this.formulario.clienteId&&this.formulario.departamentoId&&this.formulario.fechaInicio&&this.formulario.fechaFin&&this.calcularNoches()>0)}guardarReserva(){this.validarFormulario()&&(this.guardando=!0,this.reservaService.crearReserva(this.formulario).subscribe({next:n=>{n.success&&this.router.navigate(["/reservas"]),this.guardando=!1},error:n=>{console.error("Error al crear reserva:",n),this.guardando=!1}}))}cancelar(){this.router.navigate(["/reservas"])}};c.\u0275fac=function(t){return new(t||c)(v(T),v($),v(ee),v(te))},c.\u0275cmp=b({type:c,selectors:[["app-crear-reserva"]],decls:11,vars:3,consts:[["slot","start"],["defaultHref","/reservas"],[1,"container"],[4,"ngIf"],["class","loading-container",4,"ngIf"],["class","actions",4,"ngIf"],["label","Cliente","placeholder","Seleccione un cliente",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["label","Departamento","placeholder","Seleccione un departamento",3,"ngModelChange","ngModel"],["datetime","fecha-inicio"],[3,"keepContentsMounted"],["datetime","fecha-fin"],["label","Observaciones","placeholder","Observaciones adicionales...","rows","4",3,"ngModelChange","ngModel"],[3,"value"],["id","fecha-inicio","presentation","date",3,"ngModelChange","ngModel","min"],["id","fecha-fin","presentation","date",3,"ngModelChange","ngModel","min"],[1,"loading-container"],[1,"actions"],["expand","block","fill","outline","color","medium",3,"click"],["slot","start","name","close-outline"],["expand","block",3,"click","disabled"],["slot","start","name","save-outline"]],template:function(t,a){t&1&&(o(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),f(3,"ion-back-button",1),r(),o(4,"ion-title"),m(5,"Nueva Reserva"),r()()(),o(6,"ion-content")(7,"div",2),u(8,se,23,9,"ion-list",3)(9,de,4,0,"div",4)(10,me,7,2,"div",5),r()()),t&2&&(l(8),s("ngIf",!a.cargando),l(),s("ngIf",a.cargando),l(),s("ngIf",!a.cargando))},dependencies:[P,M,w,F,E,R,B,z,q,k,W,V,G,L,j,Q,H,U,D,J,N,O,A,K],styles:[".container[_ngcontent-%COMP%]{padding:16px;max-width:800px;margin:0 auto}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:40px;text-align:center}.actions[_ngcontent-%COMP%]{margin-top:24px;display:flex;gap:12px}.actions[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{flex:1}"]});let i=c;return i})();export{be as CrearReservaPage};
